<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Secure Contexts</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://www.w3.org/TR/secure-contexts/" rel="canonical">
  <meta content="68191bb08a685c1e2d2270e72d2b14b36ba96f42" name="document-revision">
<style>
    .secure {
      fill: #8F8;
    }
    .non-secure {
      fill: #F88;
      stroke-dasharray: 5,5;
    }
    rect, circle {
      stroke-width: 2;
      stroke: black;
      fill-opacity: 0.75;
    }
    text {
      font-family: monospace;
    }
    text.rejection {
      fill: #F00;
      font-weight: 700;
      font-size: 2em;
    }
    g path {
      stroke-width: 2px;
      stroke: #666;
      fill-opacity: 0;
      stroke-dasharray: 5px, 5px;
    }
  </style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1>Secure Contexts</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2023-11-10">10 November 2023</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a>
      <dt>Version History:
      <dd><a href="https://github.com/w3c/webappsec-secure-contexts/commits/main/index.bs">https://github.com/w3c/webappsec-secure-contexts/commits/main/index.bs</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5Bsecure-contexts%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[secure-contexts] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/webappsec-secure-contexts/issues">GitHub</a>
      <dt>Implementation Report:
      <dd><a href="https://wpt.fyi/results/secure-contexts">https://wpt.fyi/results/secure-contexts</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
      <dt class="editor">Former Editor:
      <dd class="editor p-author h-card vcard"><span class="p-name fn">Yan Zhu</span> (<span class="p-org org">Brave</span>)
      <dt>Participate:
      <dd><a href="https://github.com/w3c/webappsec-secure-contexts/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-secure-contexts/issues">open issues</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2023 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification defines "secure contexts", thereby allowing user agent

  implementers and specification authors to enable certain features only when
  certain minimum standards of authentication and confidentiality are met.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5Bsecure-contexts%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “secure-contexts” in the subject,
	preferably like this:
	“[secure-contexts] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/Consortium/Patent-Policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2023/Process-20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#examples-top-level"><span class="secno">1.1</span> <span class="content">Top-level Documents</span></a>
      <li><a href="#examples-framed"><span class="secno">1.2</span> <span class="content">Framed Documents</span></a>
      <li><a href="#examples-workers"><span class="secno">1.3</span> <span class="content">Web Workers</span></a>
      <li><a href="#examples-shared-workers"><span class="secno">1.4</span> <span class="content">Shared Workers</span></a>
      <li><a href="#examples-service-workers"><span class="secno">1.5</span> <span class="content">Service Workers</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">2</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li><a href="#integration-idl"><span class="secno">2.1</span> <span class="content">Integration with WebIDL</span></a>
      <li>
       <a href="#monkey-patching-html"><span class="secno">2.2</span> <span class="content">Integrations with HTML</span></a>
       <ol class="toc">
        <li><a href="#shared-workers"><span class="secno">2.2.1</span> <span class="content">Shared Workers</span></a>
        <li><a href="#monkey-patching-global-object"><span class="secno">2.2.2</span> <span class="content">Feature Detection</span></a>
        <li><a href="#is-settings-object-contextually-secure"><span class="secno">2.2.3</span> <span class="content">Secure and non-secure contexts</span></a>
       </ol>
     </ol>
    <li>
     <a href="#algorithms"><span class="secno">3</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#is-origin-trustworthy"><span class="secno">3.1</span> <span class="content"> Is <var>origin</var> potentially trustworthy? </span></a>
      <li><a href="#is-url-trustworthy"><span class="secno">3.2</span> <span class="content"> Is <var>url</var> potentially trustworthy? </span></a>
     </ol>
    <li>
     <a href="#threat-models-risks"><span class="secno">4</span> <span class="content"> Threat models and risks </span></a>
     <ol class="toc">
      <li>
       <a href="#threat-models"><span class="secno">4.1</span> <span class="content">Threat Models</span></a>
       <ol class="toc">
        <li><a href="#threat-passive"><span class="secno">4.1.1</span> <span class="content">Passive Network Attacker</span></a>
        <li><a href="#threat-active"><span class="secno">4.1.2</span> <span class="content">Active Network Attacker</span></a>
       </ol>
      <li><a href="#ancestors"><span class="secno">4.2</span> <span class="content">Ancestral Risk</span></a>
      <li><a href="#threat-risks"><span class="secno">4.3</span> <span class="content">Risks associated with non-secure contexts</span></a>
     </ol>
    <li>
     <a href="#security-considerations"><span class="secno">5</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#isolation"><span class="secno">5.1</span> <span class="content">Incomplete Isolation</span></a>
      <li><a href="#localhost"><span class="secno">5.2</span> <span class="content"><code>localhost</code></span></a>
     </ol>
    <li><a href="#privacy-considerations"><span class="secno">6</span> <span class="content">Privacy Considerations</span></a>
    <li>
     <a href="#implementation-considerations"><span class="secno">7</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#packaged-applications"><span class="secno">7.1</span> <span class="content">Packaged Applications</span></a>
      <li><a href="#development-environments"><span class="secno">7.2</span> <span class="content">Development Environments</span></a>
      <li><a href="#new"><span class="secno">7.3</span> <span class="content">Restricting New Features</span></a>
      <li>
       <a href="#legacy"><span class="secno">7.4</span> <span class="content">Restricting Legacy Features</span></a>
       <ol class="toc">
        <li><a href="#legacy-example"><span class="secno">7.4.1</span> <span class="content">Example: Geolocation</span></a>
       </ol>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">8</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>As the web platform is extended to enable more useful and powerful
  applications, it becomes increasingly important to ensure that the features
  which enable those applications are enabled only in contexts which meet a minimum
  security level. As an extension of the TAG’s recommendations in <a data-link-type="biblio" href="#biblio-securing-web" title="Securing the Web">[SECURING-WEB]</a>,
  this document describes threat models for feature abuse on the web (see <a href="#threat-models">§ 4.1 Threat Models</a>) and outlines normative requirements which should be
  incorporated into documents specifying new features (see <a href="#implementation-considerations">§ 7 Implementation Considerations</a>).</p>
    <p>The most obvious of the requirements discussed here is that application code
  with access to sensitive or private data be delivered confidentially over
  authenticated channels that guarantee data integrity. Delivering code securely
  cannot ensure that an application will always meet a user’s security and
  privacy requirements, but it is a necessary precondition.</p>
    <p>Less obviously, application code delivered over an authenticated and confidential
  channel isn’t enough in and of itself to limit the use of powerful features by
  non-secure contexts. As <a href="#ancestors">§ 4.2 Ancestral Risk</a> explains, cooperative frames can be
  abused to bypass otherwise solid restrictions on a feature. The algorithms
  defined below ensure that these bypasses are difficult and user-visible.</p>
    <p>The following examples summarize the normative text which follows:</p>
    <h3 class="heading settled" data-level="1.1" id="examples-top-level"><span class="secno">1.1. </span><span class="content">Top-level Documents</span><a class="self-link" href="#examples-top-level"></a></h3>
    <div class="example" id="example-c84aa709">
     <a class="self-link" href="#example-c84aa709"></a> 
     <p><code>http://example.com/</code> opened in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing
    context</a> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context">secure context</a>, as it was not delivered over
    an authenticated and encrypted channel.</p>
     <svg height="200" width="400">
      <g transform="translate(10,10)">
       <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://example.com/</text>
      </g>
     </svg>
    </div>
    <div class="example" id="example-13e52697">
     <a class="self-link" href="#example-13e52697"></a> 
     <p><code>https://example.com/</code> opened in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context①">top-level browsing
    context</a> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①">secure context</a>, as it was delivered over
    an authenticated and encrypted channel.</p>
     <svg height="200" width="400">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
      </g>
     </svg>
    </div>
    <div class="example" id="example-7e6c3525">
     <a class="self-link" href="#example-7e6c3525"></a> 
     <p>If a secure context opens <code>https://example.com/</code> in a new
    window, that new window will be a secure context, as it is secure on
    its own merits:</p>
     <svg height="400" width="400">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://secure.example.com/</text>
      </g>
      <g transform="translate(10,210)">
       <rect class="secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://another.example.com/</text>
      </g>
      <g>
       <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
      </g>
     </svg>
    </div>
    <div class="example" id="example-4ec7a126">
     <a class="self-link" href="#example-4ec7a126"></a> 
     <p>Likewise, if a non-secure context opens <code>https://example.com/</code> in a new window,
    that new window will be a secure context, even though its opener was non-secure:</p>
     <svg height="400" width="400">
      <g transform="translate(10,10)">
       <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://non-secure.example.com/</text>
      </g>
      <g transform="translate(10,210)">
       <rect class="secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://another.example.com/</text>
      </g>
      <g>
       <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
      </g>
     </svg>
    </div>
    <h3 class="heading settled" data-level="1.2" id="examples-framed"><span class="secno">1.2. </span><span class="content">Framed Documents</span><a class="self-link" href="#examples-framed"></a></h3>
    <p>Framed documents can be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②">secure contexts</a> if they are delivered from <a data-link-type="dfn" href="#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially trustworthy origins</a>, <em>and</em> if they’re embedded
  in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③">secure context</a>. That is:</p>
    <div class="example" id="example-d781493f">
     <a class="self-link" href="#example-d781493f"></a> If <code>https://example.com/</code> opened in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context②">top-level browsing
    context</a> opens <code>https://sub.example.com/</code> in a frame, then
    both are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context④">secure contexts</a>, as both were delivered over
    authenticated and encrypted channels.
     <p></p>
     <svg height="200" width="400">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">https://sub.example.com/</text>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-824d8fc5">
     <a class="self-link" href="#example-824d8fc5"></a> 
     <p>If <code>https://example.com/</code> was somehow able to frame <code>http://non-secure.example.com/</code> (perhaps the user has
    overridden mixed content checking?), the top-level frame would remain
    secure, but the framed content is not a secure context.</p>
     <svg height="200" width="400">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">http://non-secure.example.com/</text>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-ca732a99">
     <a class="self-link" href="#example-ca732a99"></a> 
     <p>If, on the other hand, <code>https://example.com/</code> is framed
    inside of <code>http://non-secure.example.com/</code>, then it is <em>not</em> a secure context, as its ancestor is not delivered over an
    authenticated and encrypted channel.</p>
     <svg height="200" width="400">
      <g transform="translate(10,10)">
       <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://non-secure.example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">https://example.com/</text>
       </g>
      </g>
     </svg>
    </div>
    <h3 class="heading settled" data-level="1.3" id="examples-workers"><span class="secno">1.3. </span><span class="content">Web Workers</span><a class="self-link" href="#examples-workers"></a></h3>
    <p>Dedicated Workers are similar in nature to framed documents. They’re <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context⑤">secure contexts</a> when they’re delivered from <a data-link-type="dfn" href="#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin①">potentially
  trustworthy origins</a>, only if their owner is itself a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context⑥">secure
  context</a>:</p>
    <div class="example" id="example-81f4526b">
     <a class="self-link" href="#example-81f4526b"></a> 
     <p>If <code>https://example.com/</code> in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context③">top-level browsing
    context</a> runs <code>https://example.com/worker.js</code>, then
    both the document and the worker are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context⑦">secure contexts</a>.</p>
     <svg height="200" width="600">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(400, 110)">
        <circle class="secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-3fea90e7">
     <a class="self-link" href="#example-3fea90e7"></a> 
     <p>If <code>http://non-secure.example.com/</code> in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context④">top-level browsing
    context</a> frames <code>https://example.com/</code>, which runs <code>https://example.com/worker.js</code>, then neither the framed document
    nor the worker are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context⑧">secure contexts</a>.</p>
     <svg height="200" width="600">
      <g transform="translate(10,10)">
       <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://non-secure.example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">https://example.com/</text>
       </g>
       <g transform="translate(400, 110)">
        <circle class="non-secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
     </svg>
    </div>
    <h3 class="heading settled" data-level="1.4" id="examples-shared-workers"><span class="secno">1.4. </span><span class="content">Shared Workers</span><a class="self-link" href="#examples-shared-workers"></a></h3>
    <p>Multiple contexts may attach to a Shared Worker. If a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context⑨">secure context</a> creates a Shared Worker, then it is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⓪">secure context</a>, and may only be
  attached to by other <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①①">secure contexts</a>. If a non-secure context creates
  a Shared Worker, then it is <em>not</em> a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①②">secure context</a>, and may only
  be attached to by other non-secure contexts.</p>
    <div class="example" id="example-0fa14bd0">
     <a class="self-link" href="#example-0fa14bd0"></a> 
     <p>If <code>https://example.com/</code> in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context⑤">top-level browsing
    context</a> runs <code>https://example.com/worker.js</code> as a Shared
    Worker, then both the document and the worker are considered secure
    contexts.</p>
     <svg height="200" width="600">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(400, 110)">
        <circle class="secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-5d65c447">
     <a class="self-link" href="#example-5d65c447"></a> 
     <p><code>https://example.com/</code> in a different <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context⑥">top-level
    browsing context</a> (e.g. in a new window) is a secure context, so it may
    access the secure shared worker:</p>
     <svg height="400" width="600">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(400, 110)">
        <circle class="secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
      <g transform="translate(10,200)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 -80"></path>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-91d60405">
     <a class="self-link" href="#example-91d60405"></a> 
     <p><code>https://example.com/</code> nested in <code>http://non-secure.example.com/</code> may not connect to the secure
    worker, as it is not a secure context.</p>
     <svg height="400" width="600">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(400, 110)">
        <circle class="secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
      <g transform="translate(10,200)">
       <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://non-secure.example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">https://example.com/</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
        <text class="rejection" transform="translate(405, 20)">X</text>
       </g>
      </g>
     </svg>
    </div>
    <div class="example" id="example-7ee428de">
     <a class="self-link" href="#example-7ee428de"></a> 
     <p>Likewise, if <code>https://example.com/</code> nested in <code>http://non-secure.example.com/</code> runs <code>https://example.com/worker.js</code> as a Shared
    Worker, then both the document and the worker are considered non-secure.</p>
     <svg height="400" width="600">
      <g transform="translate(10,10)">
       <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">http://non-secure.example.com/</text>
       <g transform="translate(20, 50)">
        <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
        <text transform="translate(10, 20)">https://example.com/</text>
       </g>
       <g transform="translate(400, 110)">
        <circle class="non-secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/worker.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
      <g transform="translate(10,200)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
        <text class="rejection" transform="translate(405, 20)">X</text>
       </g>
      </g>
     </svg>
    </div>
    <h3 class="heading settled" data-level="1.5" id="examples-service-workers"><span class="secno">1.5. </span><span class="content">Service Workers</span><a class="self-link" href="#examples-service-workers"></a></h3>
    <p>Service Workers are always <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①③">secure contexts</a>. Only <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①④">secure contexts</a> may register them, and they may only have clients which are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⑤">secure
  contexts</a>.</p>
    <div class="example" id="example-7c2324e2">
     <a class="self-link" href="#example-7c2324e2"></a> 
     <p>If <code>https://example.com/</code> in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context⑦">top-level browsing
    context</a> registers <code>https://example.com/service.js</code>,
    then both the document and the Service Worker are considered secure
    contexts.</p>
     <svg height="200" width="600">
      <g transform="translate(10,10)">
       <rect class="secure" height="175" width="300" x="0" y="0"></rect>
       <text transform="translate(10, 20)">https://example.com/</text>
       <g transform="translate(400, 110)">
        <circle class="secure" r="50"></circle>
        <text transform="translate(-75, -55)">https://example.com/service.js</text>
       </g>
       <g>
        <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
       </g>
      </g>
     </svg>
    </div>
   </section>
   <section class="non-normative">
    <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <h3 class="heading settled" data-level="2.1" id="integration-idl"><span class="secno">2.1. </span><span class="content">Integration with WebIDL</span><a class="self-link" href="#integration-idl"></a></h3>
    <p>A new [<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext">SecureContext</a></code>] attribute is available for operators, which
  ensures that they will only be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-exposed" id="ref-for-dfn-exposed">exposed</a> into secure contexts. The
  following example should help:</p>
    <div class="example" id="example-5703efea">
     <a class="self-link" href="#example-5703efea"></a> 
<pre class="idl highlight def"><c- b>interface</c-> <c- g>ExampleFeature</c-> {
  // This call will succeed in all contexts.
  <c- b>Promise</c-> &lt;<c- b>double</c->> <c- g>calculateNotSoSecretResult</c->();

  // This operation will not be exposed to a non-secure context.
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>] <c- b>Promise</c->&lt;<c- b>double</c->> <c- g>calculateSecretResult</c->();

  // The same applies here: the operation will not be exposed to a non-secure context.
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext②"><c- g>SecureContext</c-></a>] <c- b>boolean</c-> <c- g>getSecretBoolean</c->();
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext③"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <c- g>SecureFeature</c-> {
  // This interface will not be exposed to non-secure contexts.
  <c- b>Promise</c->&lt;<c- b>any</c->> <c- g>doAmazingThing</c->();
};
</pre>
    </div>
    <p>Specification authors are encouraged to use this attribute when defining new
  features.</p>
    <h3 class="heading settled" data-level="2.2" id="monkey-patching-html"><span class="secno">2.2. </span><span class="content">Integrations with HTML</span><a class="self-link" href="#monkey-patching-html"></a></h3>
    <h4 class="non-normative heading settled" data-level="2.2.1" id="shared-workers"><span class="secno">2.2.1. </span><span class="content">Shared Workers</span><a class="self-link" href="#shared-workers"></a></h4>
    <p>The <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker">SharedWorker</a></code> constructor will throw a "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#securityerror" id="ref-for-securityerror">SecurityError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code> exception if a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⑥">secure context</a> attempts to attach to
  a Worker which is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⑦">secure context</a>, and if a non-secure context
  attempts to attach to a Worker which is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⑧">secure context</a>.</p>
    <h4 class="heading settled" data-level="2.2.2" id="monkey-patching-global-object"><span class="secno">2.2.2. </span><span class="content">Feature Detection</span><a class="self-link" href="#monkey-patching-global-object"></a></h4>
    <p>An application can determine whether it’s executing in a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context①⑨">secure context</a> by checking the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-issecurecontext" id="ref-for-dom-issecurecontext">isSecureContext</a></code> boolean defined on <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope" id="ref-for-windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code>.</p>
    <h4 class="heading settled" data-level="2.2.3" id="is-settings-object-contextually-secure"><span class="secno">2.2.3. </span><span class="content">Secure and non-secure contexts</span><a class="self-link" href="#is-settings-object-contextually-secure"></a></h4>
    <p>The HTML Standard defines whether an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#link-options-environment" id="ref-for-link-options-environment">environment</a> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⓪">secure context</a> or a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#non-secure-context" id="ref-for-non-secure-context">non-secure context</a>. This is the primary mechanism used by other
  specifications.</p>
    <p>Given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object">global object</a>, specifications can check whether its <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings object</a> (which is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#link-options-environment" id="ref-for-link-options-environment①">environment</a>) is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②①">secure context</a>.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="algorithms"><span class="secno">3. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
    <h3 class="heading settled dfn-paneled" data-dfn-type="abstract-op" data-export data-level="3.1" data-lt="Is origin potentially trustworthy?" id="is-origin-trustworthy"><span class="secno">3.1. </span><span class="content"> Is <var>origin</var> potentially trustworthy? </span><a class="self-link" href="#is-origin-trustworthy" id="ref-for-is-origin-trustworthy"></a></h3>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="potentially-trustworthy-origin">potentially trustworthy origin</dfn> is one which a user agent
  can generally trust as delivering data securely.</p>
    <p>This algorithms considers certain hosts, scheme, and origins as potentially
  trustworthy, even though they might not be authenticated and encrypted in the
  traditional sense. In particular, the user agent SHOULD treat <code>file</code> URLs
  as potentially trustworthy. In principle the user agent could treat local
  files as untrustworthy, but, <em>given the information that is available to
  the user agent at runtime</em>, the resources appear to have been transported
  securely from disk to the user agent. Additionally, treating such resources as
  potentially trustworthy is convenient for developers building an application
  before deploying it to the public.</p>
    <p>This developer-friendlyness is not without risk, however. User agents which
  prioritize security over such niceties MAY choose to more strictly assign
  trust in a way which excludes <code>file</code>.</p>
    <p>On the other hand, the user agent MAY choose to extend this trust to other,
  vendor-specific URL schemes like <code>app:</code> or <code>chrome-extension:</code> which it can
  determine <i lang="la">a priori</i> to be trusted (see <a href="#packaged-applications">§ 7.1 Packaged Applications</a> for detail).</p>
    <p>Given an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origin</a> (<var>origin</var>), the following algorithm
  returns "<code>Potentially Trustworthy</code>" or "<code>Not Trustworthy</code>" as appropriate.</p>
    <ol>
     <li data-md>
      <p>If <var>origin</var> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>, return "<code>Not Trustworthy</code>".</p>
     <li data-md>
      <p class="assertion">Assert: <var>origin</var> is a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-tuple" id="ref-for-concept-origin-tuple">tuple origin</a>.</p>
     <li data-md>
      <p>If <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme" id="ref-for-concept-origin-scheme">scheme</a> is either "<code>https</code>" or "<code>wss</code>",
  return "<code>Potentially Trustworthy</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> This is meant to be analog to the <a data-link-type="dfn" href="https://w3c.github.io/webappsec-mixed-content/#a-priori-authenticated-url" id="ref-for-a-priori-authenticated-url"><i lang="la">a priori</i> authenticated URL</a> concept in <a data-link-type="biblio" href="#biblio-mix" title="Mixed Content">[MIX]</a>.</p>
     <li data-md>
      <p>If <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host" id="ref-for-concept-origin-host">host</a> matches one of the CIDR
  notations <code>127.0.0.0/8</code> or <code>::1/128</code> <a data-link-type="biblio" href="#biblio-rfc4632" title="Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan">[RFC4632]</a>, return "<code>Potentially       Trustworthy</code>".</p>
     <li data-md>
      <p>If the user agent conforms to the name resolution rules in <a data-link-type="biblio" href="#biblio-let-localhost-be-localhost" title="Let &apos;localhost&apos; be localhost.">[let-localhost-be-localhost]</a> and one of the following is true:</p>
      <ul>
       <li data-md>
        <p><var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host" id="ref-for-concept-origin-host①">host</a> is "<code>localhost</code>" or "<code>localhost.</code>"</p>
       <li data-md>
        <p><var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host" id="ref-for-concept-origin-host②">host</a> ends with "<code>.localhost</code>" or "<code>.localhost.</code>"</p>
      </ul>
      <p>then return "<code>Potentially Trustworthy</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> See <a href="#localhost">§ 5.2 localhost</a> for details on the requirements here.</p>
     <li data-md>
      <p>If <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme" id="ref-for-concept-origin-scheme①">scheme</a> is "<code>file</code>", return
  "<code>Potentially Trustworthy</code>".</p>
     <li data-md>
      <p>If <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme" id="ref-for-concept-origin-scheme②">scheme</a> component is one which the user
  agent considers to be authenticated, return "<code>Potentially Trustworthy</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> See <a href="#packaged-applications">§ 7.1 Packaged Applications</a> for detail here.</p>
     <li data-md>
      <p>If <var>origin</var> has been configured as a trustworthy origin, return
  "<code>Potentially Trustworthy</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> See <a href="#development-environments">§ 7.2 Development Environments</a> for detail here.</p>
     <li data-md>
      <p>Return "<code>Not Trustworthy</code>".</p>
    </ol>
    <p class="note" role="note"><span class="marker">Note:</span> Neither <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-domain" id="ref-for-concept-origin-domain">domain</a> nor <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-port" id="ref-for-concept-origin-port">port</a> has any effect on whether or not it is considered to be a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②②">secure context</a>.</p>
    <h3 class="heading settled" data-level="3.2" id="is-url-trustworthy"><span class="secno">3.2. </span><span class="content"> Is <var>url</var> potentially trustworthy? </span><a class="self-link" href="#is-url-trustworthy"></a></h3>
    <p>A <dfn data-dfn-type="dfn" data-export id="potentially-trustworthy-url">potentially trustworthy URL<a class="self-link" href="#potentially-trustworthy-url"></a></dfn> is one which either inherits
  context from its creator (<code>about:blank</code>, <code>about:srcdoc</code>, <code>data</code>) or one whose <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> is a <a data-link-type="dfn" href="#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin②">potentially trustworthy origin</a>.
  Given a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URL record</a> (<var>url</var>), the following algorithm returns "<code>Potentially   Trustworthy</code>" or "<code>Not Trustworthy</code>" as appropriate:</p>
    <ol>
     <li data-md>
      <p>If <var>url</var> is "<code>about:blank</code>" or "<code>about:srcdoc</code>", return "<code>Potentially       Trustworthy</code>".</p>
     <li data-md>
      <p>If <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is "<code>data</code>", return "<code>Potentially       Trustworthy</code>".</p>
     <li data-md>
      <p>Return the result of executing <a href="#is-origin-trustworthy" id="ref-for-is-origin-trustworthy①">§ 3.1 Is origin potentially trustworthy?</a> on <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> The origin of <code>blob:</code> URLs is the origin of the
  context in which they were created. Therefore, blobs created in a
  trustworthy origin will themselves be potentially trustworthy.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="threat-models-risks"><span class="secno">4. </span><span class="content"> Threat models and risks </span><a class="self-link" href="#threat-models-risks"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <h3 class="heading settled" data-level="4.1" id="threat-models"><span class="secno">4.1. </span><span class="content">Threat Models</span><a class="self-link" href="#threat-models"></a></h3>
    <p>Granting permissions to unauthenticated origins is, in the presence of a
  network attacker, equivalent to granting the permissions to any origin. The
  state of the Internet is such that we must indeed assume that a network
  attacker is present. Generally, network attackers fall into 2 classes:
  passive and active.</p>
    <h4 class="heading settled" data-level="4.1.1" id="threat-passive"><span class="secno">4.1.1. </span><span class="content">Passive Network Attacker</span><a class="self-link" href="#threat-passive"></a></h4>
    <p>A "Passive Network Attacker" is a party who is able to observe traffic
  flows but who lacks the ability or chooses not to modify traffic at
  the layers which this specification is concerned with.</p>
    <p>Surveillance of networks in this manner "subverts the intent of communicating
  parties without the agreement of these parties" and one "cannot defend against
  the most nefarious actors while allowing monitoring by other actors no matter
  how benevolent some might consider them to be." <a data-link-type="biblio" href="#biblio-rfc7258" title="Pervasive Monitoring Is an Attack">[RFC7258]</a> Therefore, the
  algorithms defined in this document require mechanisms that provide for the
  privacy of data at the application layer, not simply integrity.</p>
    <h4 class="heading settled" data-level="4.1.2" id="threat-active"><span class="secno">4.1.2. </span><span class="content">Active Network Attacker</span><a class="self-link" href="#threat-active"></a></h4>
    <p>An "Active Network Attacker" has all the capabilities of a "Passive Network
  Attacker" and is additionally able to modify, block or replay any data
  transiting the network.  These capabilities are available to potential
  adversaries at many levels of capability, from compromised devices offering
  or simply participating in public wireless networks, to Internet Service
  Providers indirectly introducing security and privacy vulnerabilities while
  manipulating traffic for financial gain (<a data-link-type="biblio" href="#biblio-verizon" title="Verizon looks to target its mobile subscribers with ads">[VERIZON]</a> and <a data-link-type="biblio" href="#biblio-comcast" title="Comcast Wi-Fi serving self-promotional ads via JavaScript injection">[COMCAST]</a> are
  recent examples), to parties with direct intent to compromise security or
  privacy who are able to target individual users, organizations or even
  entire populations.</p>
    <h3 class="heading settled" data-level="4.2" id="ancestors"><span class="secno">4.2. </span><span class="content">Ancestral Risk</span><a class="self-link" href="#ancestors"></a></h3>
    <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②③">secure context</a> algorithm walks
  through all the ancestors of a particular context in order to determine whether or not the
  context itself is secure. Why wouldn’t we consider a securely-delivered document in an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code> to be secure, in and of itself?</p>
    <p>The short answer is that this model would enable abuse. Chrome’s
  implementation of <a data-link-type="biblio" href="#biblio-webcryptoapi" title="Web Cryptography API">[WEBCRYPTOAPI]</a> was an early experiment in locking APIs to
  secure contexts, and it did not walk through a context’s ancestors. The
  assumption was that locking the API to a resource which was itself delivered
  securely would be enough to ensure secure usage. The result, however, was
  that entities like Netflix built <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a></code>- and <code>postMessage()</code>-based shims
  that exposed the API to non-secure contexts. The restriction was little more
  than a speed-bump, slowing down non-secure access to the API, but completely
  ineffective in preventing such access.</p>
    <p>While the algorithms in this document do not perfectly isolate non-secure
  contexts from <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②④">secure contexts</a> (as discussed in <a href="#isolation">§ 5.1 Incomplete Isolation</a>), the
  ancestor checks provide a fairly robust protection for the guarantees of
  authentication, confidentiality, and integrity that such contexts ought to
  provide.</p>
    <h3 class="heading settled" data-level="4.3" id="threat-risks"><span class="secno">4.3. </span><span class="content">Risks associated with non-secure contexts</span><a class="self-link" href="#threat-risks"></a></h3>
    <p>Certain web platform features that have a distinct impact on a user’s
  security or privacy should be available for use only in <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⑤">secure
  contexts</a> in order to defend against the threats above. Features
  available in non-secure contexts risk exposing these capabilities to
  network attackers:</p>
    <ol>
     <li> The ability to read and modify sensitive data (personally-identifying
      information, credentials, payment instruments, and so on). <a data-link-type="biblio" href="#biblio-credential-management-1" title="Credential Management Level 1">[CREDENTIAL-MANAGEMENT-1]</a> is an example of an API that handles sensitive
      data. 
     <li> The ability to read and modify input from sensors on a user’s device
      (camera, microphone, and GPS being particularly noteworthy, but
      certainly including less obviously dangerous sensors like the
      accelerometer). <a data-link-type="biblio" href="#biblio-geolocation-api" title="Geolocation API Specification 2nd Edition">[GEOLOCATION-API]</a> and <a data-link-type="biblio" href="#biblio-mediacapture-streams" title="Media Capture and Streams">[MEDIACAPTURE-STREAMS]</a> are
      historical examples of features that use sensor input. 
     <li> The ability to access information about other devices to which a user has
      access. <a data-link-type="biblio" href="#biblio-discovery-api" title="Network Service Discovery">[DISCOVERY-API]</a> and <a data-link-type="biblio" href="#biblio-web-bluetooth" title="Web Bluetooth">[WEB-BLUETOOTH]</a> are good examples. 
     <li> The ability to track users using temporary or persistent identifiers,
      including identifiers which reset themselves after some period of time
      (e.g. <code>window.sessionStorage</code>), identifiers the user can manually reset
      (e.g. <a data-link-type="biblio" href="#biblio-encrypted-media" title="Encrypted Media Extensions">[ENCRYPTED-MEDIA]</a>, Cookies <a data-link-type="biblio" href="#biblio-rfc6265" title="HTTP State Management Mechanism">[RFC6265]</a>, and <a data-link-type="biblio" href="#biblio-indexeddb" title="Indexed Database API">[IndexedDB]</a>),
      as well as identifying hardware features the user can’t easily reset. 
     <li> The ability to introduce some state for an origin which persists across
      browsing sessions. <a data-link-type="biblio" href="#biblio-service-workers" title="Service Workers">[SERVICE-WORKERS]</a> is a great example. 
     <li> The ability to manipulate a user agent’s native UI in some way which
      removes, obscures, or manipulates details relevant to a user’s
      understanding of their context. <a data-link-type="biblio" href="#biblio-fullscreen" title="Fullscreen API Standard">[FULLSCREEN]</a> is a good example. 
     <li> The ability to introduce some functionality for which user permission will
      be required. 
    </ol>
    <p>This list is non-exhaustive, but should give you a feel for the types of
  risks we should consider when writing or implementing specifications.</p>
    <p class="note" role="note"><span class="marker">Note:</span> While restricting a feature itself to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⑥">secure contexts</a> is
  critical, we ought not forget that facilities that carry such information
  (such as new network access mechanisms, or other generic functions with access
  to network data) are equally sensitive.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="security-considerations"><span class="secno">5. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    <h3 class="heading settled" data-level="5.1" id="isolation"><span class="secno">5.1. </span><span class="content">Incomplete Isolation</span><a class="self-link" href="#isolation"></a></h3>
    <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⑦">secure context</a> definition in this document does not completely
  isolate a "secure" view on an origin from a "non-secure" view on the same
  origin. Exfiltration will still be possible via increasingly esoteric
  mechanisms such as the contents of <code>localStorage</code>/<code>sessionStorage</code>, <code>storage</code> events, <code>BroadcastChannel</code>, and others.</p>
    <h3 class="heading settled" data-level="5.2" id="localhost"><span class="secno">5.2. </span><span class="content"><code>localhost</code></span><a class="self-link" href="#localhost"></a></h3>
    <p>Section 6.3 of <a data-link-type="biblio" href="#biblio-rfc6761" title="Special-Use Domain Names">[RFC6761]</a> lays out the resolution of <code>localhost.</code> and
  names falling within <code>.localhost.</code> as special, and suggests that local
  resolvers SHOULD/MAY treat them specially. For better or worse, resolvers
  often ignore these suggestions, and will send <code>localhost</code> to the network
  for resolution in a number of circumstances.</p>
    <p>Given that uncertainty, user agents MAY treat localhost names as having <a data-link-type="dfn" href="#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin③">potentially trustworthy origins</a> if and only if they also adhere to the
  localhost name resolution rules spelled out in <a data-link-type="biblio" href="#biblio-let-localhost-be-localhost" title="Let &apos;localhost&apos; be localhost.">[let-localhost-be-localhost]</a> (which boil down to ensuring that <code>localhost</code> never resolves to a
  non-loopback address).</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="privacy-considerations"><span class="secno">6. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h2>
    <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⑧">secure context</a> definition in this document does not in itself have
  any privacy impact. It does, however, enable other features which do have
  interesting privacy implications to lock themselves into contexts which
  ensures that specific guarantees can be made regarding integrity,
  authenticity, and confidentiality.</p>
    <p>From a privacy perspective, specification authors are encouraged to consider
  requiring secure contexts for the features they define.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="implementation-considerations"><span class="secno">7. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
    <h3 class="heading settled" data-level="7.1" id="packaged-applications"><span class="secno">7.1. </span><span class="content">Packaged Applications</span><a class="self-link" href="#packaged-applications"></a></h3>
    <p>A user agent that support packaged applications MAY consider as "secure"
  specific URL schemes whose contents are authenticated by the user agent.
  For example, FirefoxOS application resources are referred to by a URL whose <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a> component is <code>app:</code>. Likewise, Chrome’s extensions
  and apps live on <code>chrome-extension:</code> schemes. These could reasonably be
  considered trusted origins.</p>
    <h3 class="heading settled" data-level="7.2" id="development-environments"><span class="secno">7.2. </span><span class="content">Development Environments</span><a class="self-link" href="#development-environments"></a></h3>
    <p>In order to support developers who run staging servers on non-loopback hosts,
  the user agent MAY allow users to configure specific sets of origins as
  trustworthy, even though <a href="#is-origin-trustworthy" id="ref-for-is-origin-trustworthy②">§ 3.1 Is origin potentially trustworthy?</a> would normally return
  "<code>Not Trustworthy</code>".</p>
    <h3 class="heading settled" data-level="7.3" id="new"><span class="secno">7.3. </span><span class="content">Restricting New Features</span><a class="self-link" href="#new"></a></h3>
    <p><em>This section is non-normative.</em></p>
    <p>When writing a specification for new features, we recommend that authors
  and editors guard sensitive APIs with checks against <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context②⑨">secure contexts</a>.
  For example, something like the following might be a good approach:</p>
    <div class="example" id="example-0fe6ea9a">
     <a class="self-link" href="#example-0fe6ea9a"></a> 
     <ol>
      <li>
        If the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object">current settings object</a> is <em>not</em> a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③⓪">secure
        context</a>, then: 
       <ol>
        <li> [<i>insert something appropriate here: perhaps a Promise could be
            rejected with a <code>SecurityError</code>, an error callback could be called,
            a permission request denied, etc.</i>]. 
       </ol>
     </ol>
    </div>
    <p>Authors could alternatively ensure that sensitive APIs are only exposed to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③①">secure contexts</a> by guarding them with the [<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext④">SecureContext</a></code>] attribute.</p>
    <div class="example" id="example-2aa4b56a">
     <a class="self-link" href="#example-2aa4b56a"></a> 
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑤"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <c- g>SensitiveFeature</c-> {
  <c- b>Promise</c->&lt;<c- b>double</c->> <c- g>getTheSecretDouble</c->();
};

// Or:

<c- b>interface</c-> <c- g>AnotherSensitiveFeature</c-> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑥"><c- g>SecureContext</c-></a>] <c- n>void</c-> <c- g>doThatPowerfulThing</c->();
};
</pre>
    </div>
    <section class="non-normative">
     <h3 class="heading settled" data-level="7.4" id="legacy"><span class="secno">7.4. </span><span class="content">Restricting Legacy Features</span><a class="self-link" href="#legacy"></a></h3>
     <p><em>This section is non-normative.</em></p>
     <p>The list above clearly includes some existing functionality that is currently
    available to the web over non-secure channels. We recommend that such legacy
    functionality be modified to begin requiring a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③②">secure context</a> as
    quickly as is reasonably possible <a data-link-type="biblio" href="#biblio-w3c-process" title="W3C Process Document">[W3C-PROCESS]</a>.</p>
     <ol>
      <li data-md>
       <p>If such a feature is not widely implemented, we recommend that the
  specification be immediately <a data-link-type="dfn" href="https://www.w3.org/2023/Process-20231103/#revising-rec" id="ref-for-revising-rec">modified</a> to include a restriction
  to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③③">secure contexts</a>.</p>
      <li data-md>
       <p>If such a feature is widely implemented, but not yet in wide use, we
  recommend that it be quickly restricted to <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③④">secure contexts</a> by
  adding a check as described in <a href="#new">§ 7.3 Restricting New Features</a> to existing implementations, and <a data-link-type="dfn" href="https://www.w3.org/2023/Process-20231103/#revising-rec" id="ref-for-revising-rec①">modifying the specification</a> accordingly.</p>
      <li data-md>
       <p>If such a feature is in wide use, we recommend that the existing
  functionality be deprecated; the specification should be <a data-link-type="dfn" href="https://www.w3.org/2023/Process-20231103/#revising-rec" id="ref-for-revising-rec②">modified</a> to note that it does not
  conform to the restrictions outlined in this document, and a plan should
  be developed to both offer a conformant version of the feature and to
  migrate existing users into that new version.</p>
     </ol>
     <h4 class="heading settled" data-level="7.4.1" id="legacy-example"><span class="secno">7.4.1. </span><span class="content">Example: Geolocation</span><a class="self-link" href="#legacy-example"></a></h4>
     <p>The <a data-link-type="biblio" href="#biblio-geolocation-api" title="Geolocation API Specification 2nd Edition">[GEOLOCATION-API]</a> is a good concrete example of such a feature; it is
    widely implemented and used on a large number of non-secure sites. A reasonable
    path forward might look like this:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://www.w3.org/2023/Process-20231103/#revising-rec" id="ref-for-revising-rec③">Modify</a> the specification to include
  checks against <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③⑤">secure context</a> before executing the algorithms for <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/geolocation-api/#dom-geolocation-getcurrentposition" id="ref-for-dom-geolocation-getcurrentposition">getCurrentPosition()</a></code> and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/geolocation-api/#dom-geolocation-watchposition" id="ref-for-dom-geolocation-watchposition">watchPosition()</a></code>.</p>
       <p>If the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object①">current settings object</a> is not a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context③⑥">secure context</a>,
  then the algorithm should be aborted, and the <code>errorCallback</code> invoked with a <code>code</code> of <code>PERMISSION_DENIED</code>.</p>
      <li data-md>
       <p>The user agent should announce clear intentions to disable the API for
  non-secure contexts on a specific date, and warn developers accordingly
  (via console messages, for example).</p>
      <li data-md>
       <p>Leading up to the flag day, the user agent should announce a deprecation
  schedule to ensure both that site authors recognize the need to modify
  their code before it simply stops working altogether, and to protect
  users in the meantime. Such a plan might include any or all of:</p>
       <ol>
        <li data-md>
         <p>Disallowing persistent permission grants to non-secure origins</p>
        <li data-md>
         <p>Coarsening the accuracy of the API for non-secure origins (perhaps
  consistently returning city-level data rather than high-accuracy
  data)</p>
         <ol start="3">
          <li data-md>
           <p>UI modifications to inform users and site authors of the risk</p>
         </ol>
       </ol>
     </ol>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="acknowledgements"><span class="secno">8. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>This document is largely based on the Chrome Security team’s work on <a data-link-type="biblio" href="#biblio-powerful-new-features" title="Prefer Secure Origins For Powerful New Features">[POWERFUL-NEW-FEATURES]</a>. Chris Palmer, Ryan Sleevi, and David Dorwin have
  been particularly engaged. Anne van Kesteren, Jonathan Watt, Boris Zbarsky, and
  Henri Sivonen have also provided very helpful feedback.</p>
   </section>
  </main>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#is-origin-trustworthy">Is origin potentially trustworthy?</a><span>, in § 3</span>
   <li><a href="#potentially-trustworthy-origin">potentially trustworthy origin</a><span>, in § 3.1</span>
   <li><a href="#potentially-trustworthy-url">potentially trustworthy URL</a><span>, in § 3.2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[GEOLOCATION]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="403be618">getCurrentPosition()</span>
     <li><span class="dfn-paneled" id="4de8fec9">watchPosition()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a13a702f">SharedWorker</span>
     <li><span class="dfn-paneled" id="5f6d392d">WindowOrWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="12b8dfc0">current settings object</span>
     <li><span class="dfn-paneled" id="2672c7bc">domain</span>
     <li><span class="dfn-paneled" id="a746ba16">environment</span>
     <li><span class="dfn-paneled" id="4b6086d7">global object</span>
     <li><span class="dfn-paneled" id="77a2ee6e">host</span>
     <li><span class="dfn-paneled" id="87fcd40c">iframe</span>
     <li><span class="dfn-paneled" id="db3b2dfc">isSecureContext</span>
     <li><span class="dfn-paneled" id="5155c2d3">non-secure context</span>
     <li><span class="dfn-paneled" id="b01b1359">opaque origin</span>
     <li><span class="dfn-paneled" id="086e3aff">origin</span>
     <li><span class="dfn-paneled" id="98e31e77">port</span>
     <li><span class="dfn-paneled" id="9c4c1e66">relevant settings object</span>
     <li><span class="dfn-paneled" id="a23d12a9">scheme</span>
     <li><span class="dfn-paneled" id="65181da8">secure context</span>
     <li><span class="dfn-paneled" id="ae2a6342">top-level browsing context</span>
     <li><span class="dfn-paneled" id="1d2aa117">tuple origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MIX]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4d8718f0">a priori authenticated url</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="959ad97b">origin</span>
     <li><span class="dfn-paneled" id="3a711be7">scheme</span>
     <li><span class="dfn-paneled" id="a8c7461b">url record</span>
    </ul>
   <li>
    <a data-link-type="biblio">[W3C-PROCESS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a8e1631c">modify a specification</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="dca2de17">DOMException</span>
     <li><span class="dfn-paneled" id="b75bb3bd">SecureContext</span>
     <li><span class="dfn-paneled" id="c3e881ef">SecurityError</span>
     <li><span class="dfn-paneled" id="25c36209">exposed</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-let-localhost-be-localhost">[LET-LOCALHOST-BE-LOCALHOST]
   <dd>Mike West. <a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost"><cite>Let 'localhost' be localhost.</cite></a>. URL: <a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost">https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-let-localhost-be-localhost</a>
   <dt id="biblio-rfc4632">[RFC4632]
   <dd>V. Fuller; T. Li. <a href="https://www.rfc-editor.org/rfc/rfc4632"><cite>Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</cite></a>. August 2006. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc4632">https://www.rfc-editor.org/rfc/rfc4632</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-w3c-process">[W3C-PROCESS]
   <dd>Elika J. Etemad (fantasai); Florian Rivoal. <a href="https://www.w3.org/Consortium/Process/"><cite>W3C Process Document</cite></a>. 2 November 2021. URL: <a href="https://www.w3.org/Consortium/Process/">https://www.w3.org/Consortium/Process/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-comcast">[COMCAST]
   <dd>David Kravets. <a href="https://arstechnica.com/tech-policy/2014/09/why-comcasts-javascript-ad-injections-threaten-security-net-neutrality/"><cite>Comcast Wi-Fi serving self-promotional ads via JavaScript injection</cite></a>. URL: <a href="https://arstechnica.com/tech-policy/2014/09/why-comcasts-javascript-ad-injections-threaten-security-net-neutrality/">https://arstechnica.com/tech-policy/2014/09/why-comcasts-javascript-ad-injections-threaten-security-net-neutrality/</a>
   <dt id="biblio-credential-management-1">[CREDENTIAL-MANAGEMENT-1]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-credential-management/"><cite>Credential Management Level 1</cite></a>. URL: <a href="https://w3c.github.io/webappsec-credential-management/">https://w3c.github.io/webappsec-credential-management/</a>
   <dt id="biblio-discovery-api">[DISCOVERY-API]
   <dd>Rich Tibbett. <a href="https://dvcs.w3.org/hg/dap/raw-file/tip/discovery-api/Overview.html"><cite>Network Service Discovery</cite></a>. URL: <a href="https://dvcs.w3.org/hg/dap/raw-file/tip/discovery-api/Overview.html">https://dvcs.w3.org/hg/dap/raw-file/tip/discovery-api/Overview.html</a>
   <dt id="biblio-encrypted-media">[ENCRYPTED-MEDIA]
   <dd>David Dorwin; et al. <a href="https://w3c.github.io/encrypted-media/"><cite>Encrypted Media Extensions</cite></a>. URL: <a href="https://w3c.github.io/encrypted-media/">https://w3c.github.io/encrypted-media/</a>
   <dt id="biblio-fullscreen">[FULLSCREEN]
   <dd>Philip Jägenstedt. <a href="https://fullscreen.spec.whatwg.org/"><cite>Fullscreen API Standard</cite></a>. Living Standard. URL: <a href="https://fullscreen.spec.whatwg.org/">https://fullscreen.spec.whatwg.org/</a>
   <dt id="biblio-geolocation">[GEOLOCATION]
   <dd>Marcos Caceres; Reilly Grant. <a href="https://w3c.github.io/geolocation-api/"><cite>Geolocation API</cite></a>. URL: <a href="https://w3c.github.io/geolocation-api/">https://w3c.github.io/geolocation-api/</a>
   <dt id="biblio-geolocation-api">[GEOLOCATION-API]
   <dd>Andrei Popescu. <a href="https://w3c.github.io/geolocation-api/"><cite>Geolocation API Specification 2nd Edition</cite></a>. URL: <a href="https://w3c.github.io/geolocation-api/">https://w3c.github.io/geolocation-api/</a>
   <dt id="biblio-indexeddb">[IndexedDB]
   <dd>Nikunj Mehta; et al. <a href="https://w3c.github.io/IndexedDB/"><cite>Indexed Database API</cite></a>. URL: <a href="https://w3c.github.io/IndexedDB/">https://w3c.github.io/IndexedDB/</a>
   <dt id="biblio-mediacapture-streams">[MEDIACAPTURE-STREAMS]
   <dd>Cullen Jennings; et al. <a href="https://w3c.github.io/mediacapture-main/"><cite>Media Capture and Streams</cite></a>. URL: <a href="https://w3c.github.io/mediacapture-main/">https://w3c.github.io/mediacapture-main/</a>
   <dt id="biblio-mix">[MIX]
   <dd>Emily Stark; Mike West; Carlos IbarraLopez. <a href="https://w3c.github.io/webappsec-mixed-content/"><cite>Mixed Content</cite></a>. URL: <a href="https://w3c.github.io/webappsec-mixed-content/">https://w3c.github.io/webappsec-mixed-content/</a>
   <dt id="biblio-powerful-new-features">[POWERFUL-NEW-FEATURES]
   <dd>Chrome Security Team. <a href="https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features"><cite>Prefer Secure Origins For Powerful New Features</cite></a>. URL: <a href="https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features">https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features</a>
   <dt id="biblio-rfc6265">[RFC6265]
   <dd>A. Barth. <a href="https://httpwg.org/specs/rfc6265.html"><cite>HTTP State Management Mechanism</cite></a>. April 2011. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc6265.html">https://httpwg.org/specs/rfc6265.html</a>
   <dt id="biblio-rfc6761">[RFC6761]
   <dd>S. Cheshire; M. Krochmal. <a href="https://www.rfc-editor.org/rfc/rfc6761"><cite>Special-Use Domain Names</cite></a>. February 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6761">https://www.rfc-editor.org/rfc/rfc6761</a>
   <dt id="biblio-rfc7258">[RFC7258]
   <dd>S. Farrell; H. Tschofenig. <a href="https://www.rfc-editor.org/rfc/rfc7258"><cite>Pervasive Monitoring Is an Attack</cite></a>. May 2014. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc7258">https://www.rfc-editor.org/rfc/rfc7258</a>
   <dt id="biblio-securing-web">[SECURING-WEB]
   <dd>Mark Nottingham. <a href="https://www.w3.org/2001/tag/doc/web-https"><cite>Securing the Web</cite></a>. TAG Finding. URL: <a href="https://www.w3.org/2001/tag/doc/web-https">https://www.w3.org/2001/tag/doc/web-https</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Jake Archibald; Marijn Kruisselbrink. <a href="https://w3c.github.io/ServiceWorker/"><cite>Service Workers</cite></a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
   <dt id="biblio-verizon">[VERIZON]
   <dd>Mark Bergen; Alex Kantrowitz. <a href="http://adage.com/article/digital/verizon-target-mobile-subscribers-ads/293356/"><cite>Verizon looks to target its mobile subscribers with ads</cite></a>. URL: <a href="http://adage.com/article/digital/verizon-target-mobile-subscribers-ads/293356/">http://adage.com/article/digital/verizon-target-mobile-subscribers-ads/293356/</a>
   <dt id="biblio-web-bluetooth">[WEB-BLUETOOTH]
   <dd>Jeffrey Yasskin. <a href="https://webbluetoothcg.github.io/web-bluetooth/"><cite>Web Bluetooth</cite></a>. URL: <a href="https://webbluetoothcg.github.io/web-bluetooth/">https://webbluetoothcg.github.io/web-bluetooth/</a>
   <dt id="biblio-webcryptoapi">[WEBCRYPTOAPI]
   <dd>Mark Watson. <a href="https://w3c.github.io/webcrypto/"><cite>Web Cryptography API</cite></a>. URL: <a href="https://w3c.github.io/webcrypto/">https://w3c.github.io/webcrypto/</a>
  </dl>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['403be618'] = {"dfnID": "403be618", "url": "https://w3c.github.io/geolocation-api/#dom-geolocation-getcurrentposition", "dfnText": "getCurrentPosition()", "refSections": [{"refs": [{"id": "ref-for-dom-geolocation-getcurrentposition"}], "title": "7.4.1. Example: Geolocation"}], "external": true};
window.dfnpanelData['4de8fec9'] = {"dfnID": "4de8fec9", "url": "https://w3c.github.io/geolocation-api/#dom-geolocation-watchposition", "dfnText": "watchPosition()", "refSections": [{"refs": [{"id": "ref-for-dom-geolocation-watchposition"}], "title": "7.4.1. Example: Geolocation"}], "external": true};
window.dfnpanelData['a13a702f'] = {"dfnID": "a13a702f", "url": "https://html.spec.whatwg.org/multipage/workers.html#sharedworker", "dfnText": "SharedWorker", "refSections": [{"refs": [{"id": "ref-for-sharedworker"}], "title": "2.2.1. Shared Workers"}], "external": true};
window.dfnpanelData['5f6d392d'] = {"dfnID": "5f6d392d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#windoworworkerglobalscope", "dfnText": "WindowOrWorkerGlobalScope", "refSections": [{"refs": [{"id": "ref-for-windoworworkerglobalscope"}], "title": "2.2.2. Feature Detection"}], "external": true};
window.dfnpanelData['12b8dfc0'] = {"dfnID": "12b8dfc0", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object", "dfnText": "current settings object", "refSections": [{"refs": [{"id": "ref-for-current-settings-object"}], "title": "7.3. Restricting New Features"}, {"refs": [{"id": "ref-for-current-settings-object\u2460"}], "title": "7.4.1. Example: Geolocation"}], "external": true};
window.dfnpanelData['2672c7bc'] = {"dfnID": "2672c7bc", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-domain", "dfnText": "domain", "refSections": [{"refs": [{"id": "ref-for-concept-origin-domain"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['a746ba16'] = {"dfnID": "a746ba16", "url": "https://html.spec.whatwg.org/multipage/semantics.html#link-options-environment", "dfnText": "environment", "refSections": [{"refs": [{"id": "ref-for-link-options-environment"}, {"id": "ref-for-link-options-environment\u2460"}], "title": "2.2.3. Secure and non-secure contexts"}], "external": true};
window.dfnpanelData['4b6086d7'] = {"dfnID": "4b6086d7", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#global-object", "dfnText": "global object", "refSections": [{"refs": [{"id": "ref-for-global-object"}], "title": "2.2.3. Secure and non-secure contexts"}], "external": true};
window.dfnpanelData['77a2ee6e'] = {"dfnID": "77a2ee6e", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host", "dfnText": "host", "refSections": [{"refs": [{"id": "ref-for-concept-origin-host"}, {"id": "ref-for-concept-origin-host\u2460"}, {"id": "ref-for-concept-origin-host\u2461"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['87fcd40c'] = {"dfnID": "87fcd40c", "url": "https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element", "dfnText": "iframe", "refSections": [{"refs": [{"id": "ref-for-the-iframe-element"}, {"id": "ref-for-the-iframe-element\u2460"}], "title": "4.2. Ancestral Risk"}], "external": true};
window.dfnpanelData['db3b2dfc'] = {"dfnID": "db3b2dfc", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#dom-issecurecontext", "dfnText": "isSecureContext", "refSections": [{"refs": [{"id": "ref-for-dom-issecurecontext"}], "title": "2.2.2. Feature Detection"}], "external": true};
window.dfnpanelData['5155c2d3'] = {"dfnID": "5155c2d3", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#non-secure-context", "dfnText": "non-secure context", "refSections": [{"refs": [{"id": "ref-for-non-secure-context"}], "title": "2.2.3. Secure and non-secure contexts"}], "external": true};
window.dfnpanelData['b01b1359'] = {"dfnID": "b01b1359", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque", "dfnText": "opaque origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin-opaque"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['086e3aff'] = {"dfnID": "086e3aff", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['98e31e77'] = {"dfnID": "98e31e77", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-port", "dfnText": "port", "refSections": [{"refs": [{"id": "ref-for-concept-origin-port"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['9c4c1e66'] = {"dfnID": "9c4c1e66", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object", "dfnText": "relevant settings object", "refSections": [{"refs": [{"id": "ref-for-relevant-settings-object"}], "title": "2.2.3. Secure and non-secure contexts"}], "external": true};
window.dfnpanelData['a23d12a9'] = {"dfnID": "a23d12a9", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme", "dfnText": "scheme", "refSections": [{"refs": [{"id": "ref-for-concept-origin-scheme"}, {"id": "ref-for-concept-origin-scheme\u2460"}, {"id": "ref-for-concept-origin-scheme\u2461"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['65181da8'] = {"dfnID": "65181da8", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#secure-context", "dfnText": "secure context", "refSections": [{"refs": [{"id": "ref-for-secure-context"}, {"id": "ref-for-secure-context\u2460"}], "title": "1.1. Top-level Documents"}, {"refs": [{"id": "ref-for-secure-context\u2461"}, {"id": "ref-for-secure-context\u2462"}, {"id": "ref-for-secure-context\u2463"}], "title": "1.2. Framed Documents"}, {"refs": [{"id": "ref-for-secure-context\u2464"}, {"id": "ref-for-secure-context\u2465"}, {"id": "ref-for-secure-context\u2466"}, {"id": "ref-for-secure-context\u2467"}], "title": "1.3. Web Workers"}, {"refs": [{"id": "ref-for-secure-context\u2468"}, {"id": "ref-for-secure-context\u2460\u24ea"}, {"id": "ref-for-secure-context\u2460\u2460"}, {"id": "ref-for-secure-context\u2460\u2461"}], "title": "1.4. Shared Workers"}, {"refs": [{"id": "ref-for-secure-context\u2460\u2462"}, {"id": "ref-for-secure-context\u2460\u2463"}, {"id": "ref-for-secure-context\u2460\u2464"}], "title": "1.5. Service Workers"}, {"refs": [{"id": "ref-for-secure-context\u2460\u2465"}, {"id": "ref-for-secure-context\u2460\u2466"}, {"id": "ref-for-secure-context\u2460\u2467"}], "title": "2.2.1. Shared Workers"}, {"refs": [{"id": "ref-for-secure-context\u2460\u2468"}], "title": "2.2.2. Feature Detection"}, {"refs": [{"id": "ref-for-secure-context\u2461\u24ea"}, {"id": "ref-for-secure-context\u2461\u2460"}], "title": "2.2.3. Secure and non-secure contexts"}, {"refs": [{"id": "ref-for-secure-context\u2461\u2461"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}, {"refs": [{"id": "ref-for-secure-context\u2461\u2462"}, {"id": "ref-for-secure-context\u2461\u2463"}], "title": "4.2. Ancestral Risk"}, {"refs": [{"id": "ref-for-secure-context\u2461\u2464"}, {"id": "ref-for-secure-context\u2461\u2465"}], "title": "4.3. Risks associated with non-secure contexts"}, {"refs": [{"id": "ref-for-secure-context\u2461\u2466"}], "title": "5.1. Incomplete Isolation"}, {"refs": [{"id": "ref-for-secure-context\u2461\u2467"}], "title": "6. Privacy Considerations"}, {"refs": [{"id": "ref-for-secure-context\u2461\u2468"}, {"id": "ref-for-secure-context\u2462\u24ea"}, {"id": "ref-for-secure-context\u2462\u2460"}], "title": "7.3. Restricting New Features"}, {"refs": [{"id": "ref-for-secure-context\u2462\u2461"}, {"id": "ref-for-secure-context\u2462\u2462"}, {"id": "ref-for-secure-context\u2462\u2463"}], "title": "7.4. Restricting Legacy Features"}, {"refs": [{"id": "ref-for-secure-context\u2462\u2464"}, {"id": "ref-for-secure-context\u2462\u2465"}], "title": "7.4.1. Example: Geolocation"}], "external": true};
window.dfnpanelData['ae2a6342'] = {"dfnID": "ae2a6342", "url": "https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context", "dfnText": "top-level browsing context", "refSections": [{"refs": [{"id": "ref-for-top-level-browsing-context"}, {"id": "ref-for-top-level-browsing-context\u2460"}], "title": "1.1. Top-level Documents"}, {"refs": [{"id": "ref-for-top-level-browsing-context\u2461"}], "title": "1.2. Framed Documents"}, {"refs": [{"id": "ref-for-top-level-browsing-context\u2462"}, {"id": "ref-for-top-level-browsing-context\u2463"}], "title": "1.3. Web Workers"}, {"refs": [{"id": "ref-for-top-level-browsing-context\u2464"}, {"id": "ref-for-top-level-browsing-context\u2465"}], "title": "1.4. Shared Workers"}, {"refs": [{"id": "ref-for-top-level-browsing-context\u2466"}], "title": "1.5. Service Workers"}], "external": true};
window.dfnpanelData['1d2aa117'] = {"dfnID": "1d2aa117", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-tuple", "dfnText": "tuple origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin-tuple"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['4d8718f0'] = {"dfnID": "4d8718f0", "url": "https://w3c.github.io/webappsec-mixed-content/#a-priori-authenticated-url", "dfnText": "a priori authenticated url", "refSections": [{"refs": [{"id": "ref-for-a-priori-authenticated-url"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['959ad97b'] = {"dfnID": "959ad97b", "url": "https://url.spec.whatwg.org/#concept-url-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-url-origin"}, {"id": "ref-for-concept-url-origin\u2460"}], "title": "3.2. \n    Is url potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['3a711be7'] = {"dfnID": "3a711be7", "url": "https://url.spec.whatwg.org/#concept-url-scheme", "dfnText": "scheme", "refSections": [{"refs": [{"id": "ref-for-concept-url-scheme"}], "title": "3.2. \n    Is url potentially trustworthy?\n  "}, {"refs": [{"id": "ref-for-concept-url-scheme\u2460"}], "title": "7.1. Packaged Applications"}], "external": true};
window.dfnpanelData['a8c7461b'] = {"dfnID": "a8c7461b", "url": "https://url.spec.whatwg.org/#concept-url", "dfnText": "url record", "refSections": [{"refs": [{"id": "ref-for-concept-url"}], "title": "3.2. \n    Is url potentially trustworthy?\n  "}], "external": true};
window.dfnpanelData['a8e1631c'] = {"dfnID": "a8e1631c", "url": "https://www.w3.org/2023/Process-20231103/#revising-rec", "dfnText": "modify a specification", "refSections": [{"refs": [{"id": "ref-for-revising-rec"}, {"id": "ref-for-revising-rec\u2460"}, {"id": "ref-for-revising-rec\u2461"}], "title": "7.4. Restricting Legacy Features"}, {"refs": [{"id": "ref-for-revising-rec\u2462"}], "title": "7.4.1. Example: Geolocation"}], "external": true};
window.dfnpanelData['dca2de17'] = {"dfnID": "dca2de17", "url": "https://webidl.spec.whatwg.org/#idl-DOMException", "dfnText": "DOMException", "refSections": [{"refs": [{"id": "ref-for-idl-DOMException"}], "title": "2.2.1. Shared Workers"}], "external": true};
window.dfnpanelData['b75bb3bd'] = {"dfnID": "b75bb3bd", "url": "https://webidl.spec.whatwg.org/#SecureContext", "dfnText": "SecureContext", "refSections": [{"refs": [{"id": "ref-for-SecureContext"}, {"id": "ref-for-SecureContext\u2460"}, {"id": "ref-for-SecureContext\u2461"}, {"id": "ref-for-SecureContext\u2462"}], "title": "2.1. Integration with WebIDL"}, {"refs": [{"id": "ref-for-SecureContext\u2463"}, {"id": "ref-for-SecureContext\u2464"}, {"id": "ref-for-SecureContext\u2465"}], "title": "7.3. Restricting New Features"}], "external": true};
window.dfnpanelData['c3e881ef'] = {"dfnID": "c3e881ef", "url": "https://webidl.spec.whatwg.org/#securityerror", "dfnText": "SecurityError", "refSections": [{"refs": [{"id": "ref-for-securityerror"}], "title": "2.2.1. Shared Workers"}], "external": true};
window.dfnpanelData['25c36209'] = {"dfnID": "25c36209", "url": "https://webidl.spec.whatwg.org/#dfn-exposed", "dfnText": "exposed", "refSections": [{"refs": [{"id": "ref-for-dfn-exposed"}], "title": "2.1. Integration with WebIDL"}], "external": true};
window.dfnpanelData['is-origin-trustworthy'] = {"dfnID": "is-origin-trustworthy", "url": "#is-origin-trustworthy", "dfnText": "3.1. \n    Is origin potentially trustworthy?\n  ", "refSections": [{"refs": [{"id": "ref-for-is-origin-trustworthy"}], "title": "3.1. \n    Is origin potentially trustworthy?\n  "}, {"refs": [{"id": "ref-for-is-origin-trustworthy"}], "title": "3.2. \n    Is url potentially trustworthy?\n  "}, {"refs": [{"id": "ref-for-is-origin-trustworthy"}], "title": "7.2. Development Environments"}], "external": false};
window.dfnpanelData['potentially-trustworthy-origin'] = {"dfnID": "potentially-trustworthy-origin", "url": "#potentially-trustworthy-origin", "dfnText": "potentially trustworthy origin", "refSections": [{"refs": [{"id": "ref-for-potentially-trustworthy-origin"}], "title": "1.2. Framed Documents"}, {"refs": [{"id": "ref-for-potentially-trustworthy-origin\u2460"}], "title": "1.3. Web Workers"}, {"refs": [{"id": "ref-for-potentially-trustworthy-origin\u2461"}], "title": "3.2. \n    Is url potentially trustworthy?\n  "}, {"refs": [{"id": "ref-for-potentially-trustworthy-origin\u2462"}], "title": "5.2. localhost"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>